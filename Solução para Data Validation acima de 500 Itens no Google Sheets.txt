üìå Por que √© necess√°rio usar uma aba auxiliar?

Limita√ß√£o do menu "Dados > Valida√ß√£o de dados":
Ao usar o menu nativo do Sheets para criar uma lista suspensa com valores de um intervalo, ele exige que esse intervalo seja est√°tico ‚Äî como Aux!A1:A100.
Mas voc√™ n√£o pode configurar esse intervalo de forma din√¢mica com base em f√≥rmulas ou em eventos (como uma escolha de estado).
Al√©m disso, voc√™ n√£o consegue alterar dinamicamente o conte√∫do do intervalo de valida√ß√£o usando apenas f√≥rmulas nativas.
Com script, voc√™ pode:
Atualizar o conte√∫do da aba Aux dinamicamente (como no seu loop for);
Criar programaticamente uma regra de valida√ß√£o que aponta para esse intervalo;
Fazer tudo isso automaticamente quando o estado mudar, sem precisar reconfigurar nada manualmente.

‚ùå Por que n√£o funciona ao configurar manualmente a valida√ß√£o via menu?
Quando voc√™ tenta:
Ir no menu Dados > Valida√ß√£o de dados;
Escolher "Intervalo" e colocar, por exemplo, Aux!A1:A100...
Voc√™ est√° criando uma regra est√°tica. E h√° dois problemas:
1. A ordem da execu√ß√£o manual vs script:
O menu n√£o "espera" voc√™ atualizar a lista na aba Aux.
Se voc√™ alterar o estado (D11) e a lista Aux ainda estiver com os dados antigos, a lista suspensa vai mostrar valores errados ou desatualizados.
2. Falta de automa√ß√£o:
O menu manual n√£o consegue reagir a eventos (como onEdit) ou atualizar sozinho.
√â necess√°rio reconfigurar ou usar f√≥rmulas avan√ßadas (como INDIRECT) ‚Äî e mesmo assim, com limita√ß√µes.

‚úÖ Por que o script funciona?
Porque ele faz tudo de forma autom√°tica e sincronizada:
Atualiza a aba auxiliar no momento certo (com as cidades corretas);
Aplica a valida√ß√£o de dados imediatamente depois, com os novos dados;
Usa um intervalo est√°tico na forma, mas din√¢mico no conte√∫do (como Aux!A1:A50).
Isso permite escalar o comportamento; cada novo estado gera uma nova lista de cidades, que pode ter qualquer tamanho, sem precisar reconfigurar nada manualmente.